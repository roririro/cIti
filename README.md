# cIti




–•–æ—Ä–æ—à–æ! –î–∞–≤–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É **ControlVM** –Ω–∞ **Alt Server 10**, —á—Ç–æ–±—ã –æ–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∑–∞–¥–∞–Ω–∏—è. –Ø –æ–±—ä—è—Å–Ω—é –∫–∞–∂–¥—ã–π —à–∞–≥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ.

---

## **1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞ ControlVM**

### a) **–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏**

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã **ControlVM** –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- **VMware ESXi** (–µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É ESXi).
- **VirtualBox** (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏).
- **–û–±–ª–∞—á–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Yandex Cloud, AWS, Google Cloud).

–Ø –±—É–¥—É –æ–±—ä—è—Å–Ω—è—Ç—å –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ **VMware ESXi**, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏.

---

### b) **–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã**

1. **–í–æ–π–¥–∏—Ç–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å VMware ESXi:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ IP-–∞–¥—Ä–µ—Å—É –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ ESXi.
   - –í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞.

2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É:**
   - –ù–∞–∂–º–∏—Ç–µ **Create/Register VM**.
   - –í—ã–±–µ—Ä–∏—Ç–µ **Create a new virtual machine**.
   - –£–∫–∞–∂–∏—Ç–µ –∏–º—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã: **ControlVM**.

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã:**
   - **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: –í—ã–±–µ—Ä–∏—Ç–µ **Linux** -> **Other 5.x or later Linux (64-bit)**.
   - **vCPU**: –£–∫–∞–∂–∏—Ç–µ **2 vCPU**.
   - **RAM**: –£–∫–∞–∂–∏—Ç–µ **4 –ì–ë**.
   - **–î–∏—Å–∫**: –£–∫–∞–∂–∏—Ç–µ **30 –ì–ë** (—Ç–∏–ø –¥–∏—Å–∫–∞ ‚Äî **SSD**).

4. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –∫ —Å–µ—Ç–∏:**
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä (vSwitch), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.

5. **–ó–∞–≤–µ—Ä—à–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ **Finish**.

---

## **2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã**

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ ISO-–æ–±—Ä–∞–∑ Alt Server 10:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã **ControlVM**.
   - –í—ã–±–µ—Ä–∏—Ç–µ **CD/DVD Drive** –∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ ISO-–æ–±—Ä–∞–∑—É **Alt Server 10**.

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É:**
   - –ù–∞–∂–º–∏—Ç–µ **Power On**.
   - –ù–∞—á–Ω—ë—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å ISO-–æ–±—Ä–∞–∑–∞.

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Alt Server 10:**
   - –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞:
     - –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –∏ —Ä–∞—Å–∫–ª–∞–¥–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.
     - –£–∫–∞–∂–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—Å—å –¥–∏—Å–∫).
     - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ç—å (—É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É).
     - –ó–∞–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **root**.

4. **–ó–∞–≤–µ—Ä—à–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:**
   - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É.

---

## **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH**

### a) **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-—Å–µ—Ä–≤–µ—Ä–∞**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ SSH-—Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –æ–Ω –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):**

   ```bash
   sudo apt-get install openssh-server -y
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH:

     ```bash
     sudo nano /etc/ssh/sshd_config
     ```

   - –ù–∞–π–¥–∏—Ç–µ –∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
     - `PermitRootLogin yes` (—Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥ –ø–æ–¥ root).
     - `PasswordAuthentication no` (–æ—Ç–∫–ª—é—á–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –ø–∞—Ä–æ–ª—é).
     - `PubkeyAuthentication yes` (–≤–∫–ª—é—á–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –∫–ª—é—á—É).

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH-—Å–µ—Ä–≤–µ—Ä:**

   ```bash
   sudo systemctl restart sshd
   ```

---

### b) **–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã**

1. **–°–æ–∑–¥–∞–π—Ç–µ –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:**
   - –ï—Å–ª–∏ —É –≤–∞—Å Linux –∏–ª–∏ macOS, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

     ```bash
     ssh-keygen -t rsa -b 4096 -C "altlinux@controlvm"
     ```

   - –ï—Å–ª–∏ —É –≤–∞—Å Windows, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É **PuTTYgen**:
     - –ó–∞–ø—É—Å—Ç–∏—Ç–µ **PuTTYgen**.
     - –ù–∞–∂–º–∏—Ç–µ **Generate** –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º.
     - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (—Ñ–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.ppk`) –∏ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á.

2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ ControlVM:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `ssh-copy-id` (–Ω–∞ Linux/macOS):

     ```bash
     ssh-copy-id -i ~/.ssh/id_rsa.pub altlinux@<IP-–∞–¥—Ä–µ—Å ControlVM>
     ```

   - –ï—Å–ª–∏ —É –≤–∞—Å Windows, –≤—Ä—É—á–Ω—É—é —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ —Ñ–∞–π–ª `~/.ssh/authorized_keys` –Ω–∞ ControlVM.

---

## **4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

### a) **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ PuTTY –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä**

1. **–°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PuTTY:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç: [https://www.putty.org](https://www.putty.org).
   - –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PuTTY.

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ PuTTY.
   - –í –ø–æ–ª–µ **Host Name (or IP address)** –≤–≤–µ–¥–∏—Ç–µ IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã **ControlVM**.
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Connection** -> **SSH** -> **Auth**.
   - –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (`.ppk`).

3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å:**
   - –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ —Ä–∞–∑–¥–µ–ª **Session**.
   - –í –ø–æ–ª–µ **Saved Sessions** –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –ø—Ä–æ—Ñ–∏–ª—è: **cloud**.
   - –ù–∞–∂–º–∏—Ç–µ **Save**.

---

### b) **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ControlVM**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ PuTTY:**
   - –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å **cloud** –∏ –Ω–∞–∂–º–∏—Ç–µ **Open**.

2. **–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **altlinux**.
   - –ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ **ControlVM** –±–µ–∑ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è.

---

## **5. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è**

1. **–û—Ç–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Zabbix, Prometheus), –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏—Ö:

     ```bash
     sudo systemctl stop zabbix-agent
     sudo systemctl disable zabbix-agent
     ```

2. **–û—Ç–∫–ª—é—á–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∑–∞–¥–∞—á–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ cron), —É–¥–∞–ª–∏—Ç–µ –∏—Ö:

     ```bash
     crontab -e
     ```

   - –£–¥–∞–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

---

## **6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å ControlVM:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ **ControlVM** —á–µ—Ä–µ–∑ PuTTY.

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç:**
   - –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

     ```bash
     ping google.com
     ```

   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.

---

## **–ò—Ç–æ–≥**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ **ControlVM** —Å –¥–æ—Å—Ç—É–ø–æ–º –ø–æ SSH, –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –Ω–µ–π —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ PuTTY. –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –æ—à–∏–±–∫–∏, –Ω–∞–ø–∏—à–∏—Ç–µ, –∏ —è –ø–æ–º–æ–≥—É –≤–∞–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è! üòä



–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –Ω–∞ **Alt Server**, —á—Ç–æ–±—ã –≤—Å–µ –º–∞—à–∏–Ω—ã (–≤–∫–ª—é—á–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏) —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω—É–∂–Ω–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –ª–æ–≥–∏–∫–µ. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º –ø–æ—à–∞–≥–æ–≤–æ, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç—å –¥–ª—è –≤–∞—à–µ–π —Ç–æ–ø–æ–ª–æ–≥–∏–∏.

---

## **–¢–æ–ø–æ–ª–æ–≥–∏—è —Å–µ—Ç–∏**

–ù–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è, —Ç–æ–ø–æ–ª–æ–≥–∏—è —Å–µ—Ç–∏ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```
ControlVM  
INTERNET  

–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏  
Web1  
Web2
```

---

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º, –Ω–∞ –∫–∞–∫–∏—Ö –º–∞—à–∏–Ω–∞—Ö –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π –∏ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å.

---

## **1. –ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã?**

### a) **–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π**

–ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π (`br-internal` –∏ `br-external`) –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞ **—Ö–æ—Å—Ç–æ–≤–æ–π –º–∞—à–∏–Ω–µ**, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–µ —Å VMware ESXi –∏–ª–∏ –Ω–∞ —Ö–æ—Å—Ç–µ —Å VirtualBox). –≠—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –Ω–∞ —Ö–æ—Å—Ç–µ, —á—Ç–æ–±—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –º–æ–≥–ª–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —ç—Ç–∏–º —Å–µ—Ç—è–º.

---

### b) **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö**

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π –Ω–∞ —Ö–æ—Å—Ç–µ, –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –Ω–∞ **–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö** (ControlVM, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏, Web1, Web2). –í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å:

---

## **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–π –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö**

### a) **ControlVM**

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ ControlVM –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏ (`br-external`):**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ IP-–∞–¥—Ä–µ—Å: `10.0.0.2`.
   - –®–ª—é–∑: `10.0.0.1`.

   –ö–æ–º–∞–Ω–¥—ã –Ω–∞ ControlVM:

   ```bash
   sudo nmcli connection modify eth0 ipv4.addresses 10.0.0.2/24
   sudo nmcli connection modify eth0 ipv4.gateway 10.0.0.1
   sudo nmcli connection modify eth0 ipv4.method manual
   sudo nmcli connection up eth0
   ```

---

### b) **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏**

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏ (`br-external`):**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ IP-–∞–¥—Ä–µ—Å: `10.0.0.3`.

   –ö–æ–º–∞–Ω–¥—ã –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–µ:

   ```bash
   sudo nmcli connection modify eth0 ipv4.addresses 10.0.0.3/24
   sudo nmcli connection modify eth0 ipv4.gateway 10.0.0.1
   sudo nmcli connection modify eth0 ipv4.method manual
   sudo nmcli connection up eth0
   ```

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏ (`br-internal`):**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ IP-–∞–¥—Ä–µ—Å: `192.168.1.2`.

   –ö–æ–º–∞–Ω–¥—ã –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–µ:

   ```bash
   sudo nmcli connection modify eth1 ipv4.addresses 192.168.1.2/24
   sudo nmcli connection modify eth1 ipv4.method manual
   sudo nmcli connection up eth1
   ```

---

### c) **Web1 –∏ Web2**

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ Web1 –∏ Web2 –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏ (`br-internal`):**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ IP-–∞–¥—Ä–µ—Å–∞:
     - **Web1**: `192.168.1.10`.
     - **Web2**: `192.168.1.11`.

   –ö–æ–º–∞–Ω–¥—ã –Ω–∞ Web1:

   ```bash
   sudo nmcli connection modify eth0 ipv4.addresses 192.168.1.10/24
   sudo nmcli connection modify eth0 ipv4.gateway 192.168.1.2
   sudo nmcli connection modify eth0 ipv4.method manual
   sudo nmcli connection up eth0
   ```

   –ö–æ–º–∞–Ω–¥—ã –Ω–∞ Web2:

   ```bash
   sudo nmcli connection modify eth0 ipv4.addresses 192.168.1.11/24
   sudo nmcli connection modify eth0 ipv4.gateway 192.168.1.2
   sudo nmcli connection modify eth0 ipv4.method manual
   sudo nmcli connection up eth0
   ```

---

## **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤—è–∑—å –º–µ–∂–¥—É –º–∞—à–∏–Ω–∞–º–∏:**
   - –° **ControlVM** –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞:

     ```bash
     ping 10.0.0.3
     ```

   - –° **–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞** –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Web1 –∏ Web2:

     ```bash
     ping 192.168.1.10
     ping 192.168.1.11
     ```

   - –° **Web1** –∏ **Web2** –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞:

     ```bash
     ping 192.168.1.2
     ```

---

## **4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏**

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–µ:**

   ```bash
   sudo sysctl -w net.ipv4.ip_forward=1
   sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–∞ Web1 –∏ Web2:**

   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –∫–∞–∫ —à–ª—é–∑ –¥–ª—è –≤—ã—Ö–æ–¥–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.

   ```bash
   sudo ip route add default via 192.168.1.2
   ```

---

## **–ò—Ç–æ–≥**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –º–∞—à–∏–Ω—ã:
- **ControlVM** –∏ **–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫** –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏ (`br-external`).
- **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫**, **Web1** –∏ **Web2** –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏ (`br-internal`).

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –æ—à–∏–±–∫–∏, –Ω–∞–ø–∏—à–∏—Ç–µ, –∏ —è –ø–æ–º–æ–≥—É –≤–∞–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è! üòä
### b) **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤**

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ IP-–∞–¥—Ä–µ—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã:**

   - **ControlVM:**
     - –í–Ω–µ—à–Ω–∏–π IP: `10.0.0.2`
     - –®–ª—é–∑: `10.0.0.1`
   - **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏:**
     - –í–Ω–µ—à–Ω–∏–π IP: `10.0.0.3`
     - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP: `192.168.1.2`
   - **Web1:**
     - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP: `192.168.1.10`
   - **Web2:**
     - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP: `192.168.1.11`

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ IP-–∞–¥—Ä–µ—Å–∞ –Ω–∞ –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω–µ:**

   –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è **Web1**:

   ```bash
   sudo nmcli connection modify eth0 ipv4.addresses 192.168.1.10/24
   sudo nmcli connection modify eth0 ipv4.gateway 192.168.1.1
   sudo nmcli connection modify eth0 ipv4.method manual
   sudo nmcli connection up eth0
   ```

   –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–∞—à–∏–Ω.

---

### c) **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏**

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–µ –Ω–∞–≥—Ä—É–∑–∫–∏:**

   –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É –≤–Ω–µ—à–Ω–µ–π –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç—è–º–∏.

   ```bash
   sudo sysctl -w net.ipv4.ip_forward=1
   sudo iptables -t nat -A POSTROUTING -o br-external -j MASQUERADE
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞—Ö (Web1, Web2):**

   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –∫–∞–∫ —à–ª—é–∑ –¥–ª—è –≤—ã—Ö–æ–¥–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.

   ```bash
   sudo ip route add default via 192.168.1.2
   ```

---

## **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏**

### a) **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–µ –Ω–∞–≥—Ä—É–∑–∫–∏:**

   ```bash
   sudo apt-get install nginx -y
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏:**

   –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª Nginx:

   ```bash
   sudo nano /etc/nginx/nginx.conf
   ```

   –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

   ```nginx
   http {
       upstream backend {
           server 192.168.1.10;
           server 192.168.1.11;
       }

       server {
           listen 80;
           server_name balance.example.com;

           location / {
               proxy_pass http://backend;
           }
       }
   }
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:**

   ```bash
   sudo systemctl restart nginx
   ```

---

### b) **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

1. **–†–∞–∑—Ä–µ—à–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ –ø–æ HTTP –∏ HTTPS:**

   ```bash
   sudo ufw allow 80/tcp
   sudo ufw allow 443/tcp
   ```

2. **–ó–∞–ø—Ä–µ—Ç–∏—Ç–µ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã:**

   ```bash
   sudo ufw default deny incoming
   sudo ufw enable
   ```

---

## **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ (Web1, Web2)**

### a) **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, Apache –∏–ª–∏ Nginx):**

   ```bash
   sudo apt-get install apache2 -y
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:**

   –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è **Web1**:

   ```bash
   echo "Hello from Web1" | sudo tee /var/www/html/index.html
   ```

   –î–ª—è **Web2**:

   ```bash
   echo "Hello from Web2" | sudo tee /var/www/html/index.html
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä:**

   ```bash
   sudo systemctl start apache2
   sudo systemctl enable apache2
   ```

---

## **4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫:**

   –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É `http://<IP-–∞–¥—Ä–µ—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞>`. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ (Web1 –∏–ª–∏ Web2).

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É:**

   –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑. –í—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å, —á—Ç–æ –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–¥—É—é—Ç—Å—è –º–µ–∂–¥—É Web1 –∏ Web2.

---

## **5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPN –¥–ª—è WebAdm**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ OpenVPN –Ω–∞ WebAdm:**

   ```bash
   sudo apt-get install openvpn -y
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ VPN-—Ç—É–Ω–Ω–µ–ª—å:**

   –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è VPN –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Web1 –∏ Web2.

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ WebAdm –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ Web1 –∏ Web2 —á–µ—Ä–µ–∑ VPN.

---

## **–ò—Ç–æ–≥**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å–µ—Ç—å, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ã. –í—Å–µ –º–∞—à–∏–Ω—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º, –∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É Web1 –∏ Web2. –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –æ—à–∏–±–∫–∏, –Ω–∞–ø–∏—à–∏—Ç–µ, –∏ —è –ø–æ–º–æ–≥—É –≤–∞–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è! üòä




–î–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –æ–±–ª–∞—á–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ **Alt Server** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω, —Å–µ—Ç–µ–π –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º –≤—Å—ë –ø–æ—ç—Ç–∞–ø–Ω–æ. –Ø –æ–±—ä—è—Å–Ω—é, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã, —Å–µ—Ç–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.

---

## **1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω**

### a) **–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω**

1. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã:**
   - **ControlVM**:
     - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: **Alt Server p10-cloud**.
     - vCPU: 2.
     - RAM: 4 –ì–ë.
     - –î–∏—Å–∫: 30 –ì–ë (SSD).
   - **Web1** –∏ **Web2**:
     - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: **Alt p10 StarterKit**.
     - vCPU: 1.
     - RAM: 1024 –ú–ë.
     - –î–∏—Å–∫: 10 –ì–ë (HDD).
   - **WebAdm**:
     - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: **Alt Server p10-cloud**.
     - vCPU: 1.
     - RAM: 1024 –ú–ë.
     - –î–∏—Å–∫: 10 –ì–ë (HDD).

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ISO-–æ–±—Ä–∞–∑—ã **Alt p10 StarterKit** –∏ **Alt Server p10-cloud** –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–° –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã.

---

## **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–π**

### a) **–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π**

1. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏:**
   - **–í–Ω–µ—à–Ω—è—è —Å–µ—Ç—å** (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É):
     - –ù–∞–∑–≤–∞–Ω–∏–µ: `external-net`.
     - –î–∏–∞–ø–∞–∑–æ–Ω IP: `10.0.0.0/24`.
   - **–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å** (–¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–º –∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞–º–∏):
     - –ù–∞–∑–≤–∞–Ω–∏–µ: `internal-net`.
     - –î–∏–∞–ø–∞–∑–æ–Ω IP: `192.168.1.0/24`.

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –∫ —Å–µ—Ç—è–º:**
   - **ControlVM**: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `external-net`.
   - **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏**: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `external-net` –∏ `internal-net`.
   - **Web1** –∏ **Web2**: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `internal-net`.
   - **WebAdm**: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `external-net`.

---

## **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–∞**

### a) **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤**

1. **–ù–∞–∑–Ω–∞—á—å—Ç–µ IP-–∞–¥—Ä–µ—Å–∞:**
   - **ControlVM**: `10.0.0.2`.
   - **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏**: `10.0.0.3` (–≤–Ω–µ—à–Ω–∏–π), `192.168.1.2` (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π).
   - **Web1**: `192.168.1.10`.
   - **Web2**: `192.168.1.11`.
   - **WebAdm**: `10.0.0.4`.

2. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ IP-–∞–¥—Ä–µ—Å–∞ –≤ —Ñ–∞–π–ª `/home/altlinux/white.ip`:**

   ```bash
   echo "ControlVM: 10.0.0.2" > /home/altlinux/white.ip
   echo "–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫: 10.0.0.3" >> /home/altlinux/white.ip
   echo "Web1: 192.168.1.10" >> /home/altlinux/white.ip
   echo "Web2: 192.168.1.11" >> /home/altlinux/white.ip
   echo "WebAdm: 10.0.0.4" >> /home/altlinux/white.ip
   ```

### b) **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH**

1. **–°–æ–∑–¥–∞–π—Ç–µ –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É –¥–ª—è SSH:**

   ```bash
   ssh-keygen -t rsa -b 4096 -C "altlinux@controlvm"
   ```

   –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á–∏ –≤ `/home/altlinux/.ssh/id_rsa`.

2. **–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ –≤—Å–µ –º–∞—à–∏–Ω—ã:**

   ```bash
   ssh-copy-id -i ~/.ssh/id_rsa.pub altlinux@10.0.0.3
   ssh-copy-id -i ~/.ssh/id_rsa.pub altlinux@192.168.1.10
   ssh-copy-id -i ~/.ssh/id_rsa.pub altlinux@192.168.1.11
   ssh-copy-id -i ~/.ssh/id_rsa.pub altlinux@10.0.0.4
   ```

3. **–û—Ç–∫–ª—é—á–∏—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –ø–∞—Ä–æ–ª—é:**

   –ù–∞ –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `/etc/ssh/sshd_config`:

   ```bash
   PasswordAuthentication no
   ```

   –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH:

   ```bash
   sudo systemctl restart sshd
   ```

---

## **4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏**

### a) **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–µ –Ω–∞–≥—Ä—É–∑–∫–∏:**

   ```bash
   sudo apt-get install nginx -y
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É:**

   –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª Nginx:

   ```bash
   sudo nano /etc/nginx/nginx.conf
   ```

   –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

   ```nginx
   http {
       upstream backend {
           server 192.168.1.10;
           server 192.168.1.11;
       }

       server {
           listen 80;
           server_name balance.example.com;

           location / {
               proxy_pass http://backend;
           }
       }
   }
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:**

   ```bash
   sudo systemctl restart nginx
   ```

---

## **5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPN –¥–ª—è WebAdm**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ OpenVPN –Ω–∞ WebAdm:**

   ```bash
   sudo apt-get install openvpn -y
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ VPN-—Ç—É–Ω–Ω–µ–ª—å:**

   –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è VPN –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Web1 –∏ Web2.

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ WebAdm –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ Web1 –∏ Web2 —á–µ—Ä–µ–∑ VPN.

---

## **6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫:**

   –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É `http://<IP-–∞–¥—Ä–µ—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞>`. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ (Web1 –∏–ª–∏ Web2).

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É:**

   –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑. –í—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å, —á—Ç–æ –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–¥—É—é—Ç—Å—è –º–µ–∂–¥—É Web1 –∏ Web2.

---

## **–ò—Ç–æ–≥**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –æ–±–ª–∞—á–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∏ VPN-—Ç—É–Ω–Ω–µ–ª–µ–º. –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –æ—à–∏–±–∫–∏, –Ω–∞–ø–∏—à–∏—Ç–µ, –∏ —è –ø–æ–º–æ–≥—É –≤–∞–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è! üòä




–•–æ—Ä–æ—à–æ! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∫—Ä–∏–ø—Ç **cloudinit.sh** –Ω–∞ –º–∞—à–∏–Ω–µ **ControlVM** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –Ø –æ–±—ä—è—Å–Ω—é –≤—Å—ë –ø–æ—ç—Ç–∞–ø–Ω–æ.

---

## **1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏**

1. **–°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/home/altlinux/bin`:**

   ```bash
   mkdir -p /home/altlinux/bin
   ```

2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Å–æ–∑–¥–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:**

   ```bash
   cd /home/altlinux/bin
   ```

---

## **2. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `cloud.conf`**

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `cloud.conf`:**

   ```bash
   nano /home/altlinux/bin/cloud.conf
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

   ```ini
   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–ª–∞—á–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
   PROVIDER="aws"  # –ò–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, yandex, google)
   REGION="us-east-1"  # –†–µ–≥–∏–æ–Ω
   ACCESS_KEY="your_access_key"  # –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞
   SECRET_KEY="your_secret_key"  # –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á

   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
   LOAD_BALANCER_NAME="my-balancer"
   LOAD_BALANCER_PORT="80"
   BACKEND_SERVERS="192.168.1.10,192.168.1.11"  # IP-–∞–¥—Ä–µ—Å–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤

   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤
   WEB1_IP="192.168.1.10"
   WEB2_IP="192.168.1.11"
   ```

3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –∑–∞–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª (`Ctrl + O`, –∑–∞—Ç–µ–º `Ctrl + X`).**

---

## **3. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ `cloudinit.sh`**

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `cloudinit.sh`:**

   ```bash
   nano /home/altlinux/bin/cloudinit.sh
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:**

   ```bash
   #!/bin/bash

   # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   source /home/altlinux/bin/cloud.conf

   # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
   check_resource() {
       local resource=$1
       if ping -c 1 "$resource" &> /dev/null; then
           echo "–†–µ—Å—É—Ä—Å $resource –¥–æ—Å—Ç—É–ø–µ–Ω."
       else
           echo "–û—à–∏–±–∫–∞: —Ä–µ—Å—É—Ä—Å $resource –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω."
           exit 1
       fi
   }

   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤
   echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤..."
   for server in $(echo "$BACKEND_SERVERS" | tr ',' ' '); do
       check_resource "$server"
   done

   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
   echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏..."
   check_resource "$LOAD_BALANCER_NAME"

   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ (–ø—Ä–∏–º–µ—Ä –¥–ª—è AWS)
   echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏..."
   aws elbv2 create-load-balancer \
       --name "$LOAD_BALANCER_NAME" \
       --subnets subnet-12345678 \
       --security-groups sg-12345678 \
       --region "$REGION"

   # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫
   echo "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫..."
   for server in $(echo "$BACKEND_SERVERS" | tr ',' ' '); do
       aws elbv2 register-targets \
           --target-group-arn "arn:aws:elasticloadbalancing:$REGION:123456789012:targetgroup/my-target-group" \
           --targets "Id=$server,Port=80"
   done

   echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞."
   ```

3. **–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:**

   ```bash
   chmod +x /home/altlinux/bin/cloudinit.sh
   ```

---

## **4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**

   - –î–ª—è —Ä–∞–±–æ—Ç—ã —Å AWS CLI (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AWS):

     ```bash
     sudo apt-get install awscli -y
     ```

   - –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –æ–±–ª–∞—á–Ω–æ–º—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É:**

   - –î–ª—è AWS:

     ```bash
     aws configure
     ```

     –í–≤–µ–¥–∏—Ç–µ `ACCESS_KEY`, `SECRET_KEY`, `REGION` –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

---

## **5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:**

   ```bash
   /home/altlinux/bin/cloudinit.sh
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥:**
   - –°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏.
   - –ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞."

---

## **6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è**

1. **–î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –í –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–±–∞–≤—å—Ç–µ:

     ```bash
     LOG_FILE="/home/altlinux/bin/cloudinit.log"
     exec > >(tee -a "$LOG_FILE") 2>&1
     ```

   - –≠—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –≤—ã–≤–æ–¥—ã —Å–∫—Ä–∏–ø—Ç–∞ –≤ —Ñ–∞–π–ª `cloudinit.log`.

2. **–î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `set -e` –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞, —á—Ç–æ–±—ã –æ–Ω –∑–∞–≤–µ—Ä—à–∞–ª—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ.

3. **–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `awscli`) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

     ```bash
     if ! command -v aws &> /dev/null; then
         echo "–û—à–∏–±–∫–∞: awscli –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
         exit 1
     fi
     ```

---

## **–ò—Ç–æ–≥**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç **cloudinit.sh**, –∫–æ—Ç–æ—Ä—ã–π:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞ `cloud.conf`.
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤.
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ã.

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –æ—à–∏–±–∫–∏, –Ω–∞–ø–∏—à–∏—Ç–µ, –∏ —è –ø–æ–º–æ–≥—É –≤–∞–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è! üòä












https://dzen.ru/a/Z8oUcB8cdyPBusex

